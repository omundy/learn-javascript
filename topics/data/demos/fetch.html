<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>Javascript - fetch() examples</title>
</head>

<body>

    <div class="container">
        <h3><a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch">fetch()</a> examples</h3>
        <p>Open the console to see messages</p>
        <p>NOTE: Because of CORS you <a href="../data.md#cors">may need to run this file in a server environment</a></p>
    </div>

    <div class="container">
        <h4 class="mt-3">Cat Facts API <a href="https://alexwohlbruck.github.io/cat-facts/docs/">docs</a></h4>
        <button class="btn btn-sm btn-dark catFactsBtn" name="button">catFactsBtn</button>

        <h4 class="mt-3">Sentiment API <a href="https://sentim-api.herokuapp.com/">docs</a></h4>
        <button class="btn btn-sm btn-dark sentimentBtnLoveChoco" name="button">"I like chocolate"</button>
        <button class="btn btn-sm btn-dark sentimentBtnLikeChoco" name="button">"I like chocolate"</button>
        <button class="btn btn-sm btn-dark sentimentBtnHateChoco" name="button">"I hate chocolate"</button>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        // LISTENERS
        $('.catFactsBtn').click(fetchCatFacts);
        $('.sentimentBtnLoveChoco').click(() => {
            fetchSentiment("I love chocolate")
        });
        $('.sentimentBtnLikeChoco').click(() => {
            fetchSentiment("I like chocolate")
        });
        $('.sentimentBtnHateChoco').click(() => {
            fetchSentiment("I hate chocolate")
        });



        // FUNCTIONS

        function fetchCatFacts() {
            fetch('https://cat-fact.herokuapp.com/facts/random') // request an external resource
                .then(response => {
                    console.log(response.status); // -> 200
                    console.log(response.statusText); // -> "OK"
                    console.log(response); // log the response object
                    return response.json(); // parse response body (convert to JSON)
                })
                .then(data => {
                    console.log(data); // log the object
                });
        }


        function fetchSentiment(text) {
            // data to send to the sentiment api
            var requestData = {
                "text": text
            };

            fetch('https://sentim-api.herokuapp.com/api/v1/', {
                    method: "POST",
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestData)
                })
                .then(response => {
                    return response.json();
                })
                .then(responseData => {
                    console.log(
                        responseData.sentences[0].sentence,
                        responseData.sentences[0].sentiment.polarity,
                        responseData.sentences[0].sentiment.type,
                        responseData);
                });
        }
    </script>
</body>

</html>

<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/themes/prism.min.css" /> -->
    <link rel="stylesheet" href="../../../assets/libs/prism/1.25.0/prism.min.css" />
    <link rel="stylesheet" href="../../../assets/libs/prism/themes/prism-vsc-dark-plus.css" />
    <title>Client side storage</title>
</head>

<body>

    <div class="container">
        <div class="row">
            <div class="col">

                <h1>Client side storage</h1>

                <p>How to store and access data in the browser using cookies, localstorage, etc. with Javascript. Some rules apply:</p>

                <p><b>Open Dev Tools > Application to see the data</b></p>

            </div>
        </div>
    </div>



    <div class="container">



        <div class="row my-3">
            <div class="col">

                <h3>Web Storage API</h3>

                <p>Mozilla <a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Client-side_web_APIs/Client-side_storage">Client-side storage</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API">Web Storage
                        API</a></p>



                <p>Change the value of localStorage <b>counter</b> variable ...</p>

                <form class="row g-3 mb-3">
                    <div class="col-2">
                        <label for="ls1changevalue" class="visually-hidden">Value</label>
                        <input type="text" class="form-control ls1changevalue" value="1">
                    </div>
                    <div class="col-auto">
                        <button type="button" class="btn btn-primary ls1subbtn">-</button>
                    </div>
                    <div class="col-auto">
                        <button type="button" class="btn btn-primary ls1addbtn">+</button>
                    </div>
                    <div class="col-auto">
                        <label for="ls1value" class="visually-hidden">Counter</label>
                        <input type="text" class="form-control ls1value">
                    </div>
                    <div class="col-auto">
                        <button type="button" class="btn btn-primary ls1resetbtn">reset</button>
                    </div>
                    <div class="col-auto">
                        <button type="button" class="btn btn-primary ls1removebtn">remove</button>
                    </div>
                </form>

                <pre><code class="language-js">
                    // get current value or zero
                    let counter = Number(localStorage.getItem("counter")) || 0;
                    localStorage.setItem("counter", counter + 1);
            </code></pre>



                <p>Enter data and press button to save data in localstorage</p>

                <form class="row g-3 mb-3">
                    <div class="col-auto">
                        <label for="ls2key" class="visually-hidden">Key</label>
                        <input type="text" class="form-control" id="ls2key" placeholder="key">
                    </div>
                    <div class="col-auto">
                        <label for="ls2value" class="visually-hidden">Value</label>
                        <input type="text" class="form-control" id="ls2value" placeholder="value">
                    </div>
                    <div class="col-auto">
                        <button type="submit" class="btn btn-primary ls2btn">save</button>
                    </div>
                </form>

                <pre><code class="language-js">

            </code></pre>

            </div>
        </div>





        <div class="row my-3">
            <div class="col">

                <h3>Cookies</h3>

                <h4>Console test</h4>

                You cannot use file:// urls; You must <a href="https://github.com/omundy/dig245-critical-web-design/blob/main/topics/servers/web-servers.md#development-servers">run this on a server</a> or localhost.


                Copy and paste to the console to create a cookie
                <pre><code class="language-js">
                    document.cookie = "hello world!";
                </code></pre>

            </div>
        </div>
        <div class="row my-3">
            <div class="col">

                <h3>2 - Create a cookie with a button</h3>

                Copy and paste to the console
                <pre><code class="language-js">
                    document.cookie = "hello world!";
                </code></pre>

                <button class="btn btn-primary btn1">Create a cookie</button>

            </div>
        </div>



    </div>





    <div class="container my-5">
        <div class="row">
            <div class="col">

                <h3>Example 1 - Create a cookie in the console</h3>


                <blockquote contenteditable="true" onkeyup="setCookie(this.innerText); document.title = this.innerText;" spellcheck="false">
                    <p>Edit this content to add your own quote</p>
                </blockquote>

                <cite contenteditable="true">-- Write your own name here</cite>

            </div>
        </div>
    </div>










    <div class="container my-5">
        <div class="row">
            <div class="col">
                The following were used to create this example:

                <ul>
                    <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/contenteditable">MDN contenteditable</a></li>
                    <li><a href="https://stickyscreen.org">stickyscreen.org</a> by Jack Cheng</li>
                    <li><a href="https://www.w3schools.com/js/js_cookies.asp">W3Schools Cookies</a></li>
                    <li><a href="https://www.quirksmode.org/js/cookies.html">quirksmode</a></li>



                </ul>

            </div>
        </div>
    </div>






    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/prism.min.js"></script> -->
    <script src="../../../assets/libs/prism/1.25.0/prism.min.js"></script>

    <script>
        // localstorage - variable storage

        $(".ls1subbtn").click(function() {
            let counter = Number(localStorage.getItem("counter")) || 0; // get current value or zero
            localStorage.setItem("counter", counter - Number($(".ls1changevalue").val()));
        });
        $(".ls1addbtn").click(function() {
            let counter = Number(localStorage.getItem("counter")) || 0; // get current value or zero
            localStorage.setItem("counter", counter + Number($(".ls1changevalue").val()));
        });
        $(".ls1resetbtn").click(function() {
            localStorage.setItem("counter", 0);
        });
        $(".ls1removebtn").click(function() {
            localStorage.removeItem("counter");
        });

        $(".ls1subbtn, .ls1addbtn, .ls1resetbtn, .ls1removebtn").on("click", showls1value);

        function showls1value() {
            let counter = localStorage.getItem("counter") || "null";
            $(".ls1value").val(counter);
        }
        showls1value();



        // localStorage - object storage


        function setObject(key, obj) {
            localStorage.setItem(key, JSON.stringify(obj));
        }

        function getObject(key) {
            return JSON.parse(localStorage.getItem(key));
        }

        // let myObject = {
        //     a: 1,
        //     b: 2,
        //     c: 3
        // };
        // storeObject("testObject", myObject);








        // cookie


        $(document).on('click', '.btn1', () => {
            document.cookie = "cookie created from a button";
        });
    </script>



    <script>
        // // set cookie expiration to a year from current time
        // var expires = new Date();
        // expires.setTime(expires.getTime() + (1000 * 60 * 60 * 24 * 365));
        //
        // // populate the sticky and site title with cookie contents
        // var sticky = document.getElementById('sticky');
        // getCookie(sticky);
        //
        // // intercept paste to strip preformatted text
        // sticky.addEventListener('paste', function(e) {
        //   e.preventDefault();
        //   var text = e.clipboardData.getData('text/plain');
        //   if (document.queryCommandSupported('insertText')) {
        //     document.execCommand('insertText', false, text);
        //   } else {
        //     document.execCommand('paste', false, text); // for ie
        //   }
        // })
        //
        // function setCookie(value) {
        //   document.cookie = "notetoself=" + escape(value) + "; path=/" + ((expires == null) ? "" : "; expires=" + expires.toGMTString());
        // }
        //
        // function getCookie(e) {
        //   var note = document.cookie.match('(^|;)\\s*' + "notetoself" + '\\s*=\\s*([^;]+)');
        //   if (document.cookie) {
        //     e.innerText = unescape(note ? note.pop() : '');
        //     document.title = unescape(note ? note.pop() : '');
        //   } else {
        //     e.innerText = "1. Type note here.\n2. Set as homepage.\n3. Get to work!";
        //     setCursor(e);
        //   }
        // }
        //
        // // sets cursor to end of contenteditable div
        // function setCursor(e) {
        //   var range, selection;
        //   //ff, chrome, opera, safari, ie 9+
        //   if (document.createRange) {
        //     range = document.createRange();
        //     range.selectNodeContents(e);
        //     range.collapse(false);
        //     selection = window.getSelection();
        //     selection.removeAllRanges();
        //     selection.addRange(range);
        //   } else {
        //     e.focus();
        //   }
        // }
    </script>



</body>

</html>
